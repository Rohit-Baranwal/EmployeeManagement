@model EmployeeManagement.Models.Employee

@{
    ViewBag.Title = "Edit Employee";
}

<h2>Edit Employee</h2>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    @Html.HiddenFor(m => m.EmployeeId)

    <div class="form-group">
        @Html.LabelFor(m => m.FullName)
        @Html.TextBoxFor(m => m.FullName, new { @class = "form-control" })
    </div>

    <div class="form-group">
        @Html.LabelFor(m => m.Email)
        @Html.TextBoxFor(m => m.Email, new { @class = "form-control" })
    </div>

    <div class="form-group">
        @Html.LabelFor(m => m.Department)
        @Html.TextBoxFor(m => m.Department, new { @class = "form-control" })
    </div>

    <div class="form-group">
        @Html.LabelFor(m => m.Salary)
        @Html.TextBoxFor(m => m.Salary, new { @class = "form-control" })
    </div>

    <div class="form-group">
        @Html.Label("State")
        @Html.DropDownListFor(
            m => m.StateId,
            ViewBag.States as SelectList,
            "-- Select State --",
            new { @class = "form-control", id = "StateId" }
        )
    </div>

    <div class="form-group">
        @Html.Label("City")
        @Html.DropDownListFor(
            m => m.CityId,
            ViewBag.Cities as SelectList,
            "-- Select City --",
            new { @class = "form-control", id = "CityId" }
        )
    </div>

    <button type="submit" class="btn btn-primary">Update</button>
    @Html.ActionLink("Back to List", "Index", null, new { @class = "btn btn-secondary" })
}


<script src="~/Scripts/jquery-3.4.1.min.js"></script>

<script>
    $("#StateId").change(function () {
        var stateId = $(this).val();

        $("#CityId").empty();
        $("#CityId").append('<option>-- Select City --</option>');

        if (stateId !== "") {
            $.getJSON('/Employee/GetCitiesByState',
                { stateId: stateId },
                function (data) {
                    $.each(data, function (i, item) {
                        $("#CityId").append(
                            $('<option></option>').val(item.CityId).text(item.CityName)
                        );
                    });
                });
        }
    });
</script>

